<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<title>
  File: import
  
    &mdash; Documentation by YARD 0.8.5.2
  
</title>

  <link rel="stylesheet" href="css/style.css" type="text/css" media="screen" charset="utf-8" />

  <link rel="stylesheet" href="css/common.css" type="text/css" media="screen" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  hasFrames = window.top.frames.main ? true : false;
  relpath = '';
  framesUrl = "frames.html#!" + escape(window.location.href);
</script>


  <script type="text/javascript" charset="utf-8" src="js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="js/app.js"></script>


  </head>
  <body>
    <div id="header">
      <div id="menu">
  
    <a href="_index.html">Index</a> &raquo; 
    <span class="title">File: import</span>
  

  <div class="noframes"><span class="title">(</span><a href="." target="_top">no frames</a><span class="title">)</span></div>
</div>

      <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="class_list.html">
      Class List
    </a>
  
    <a class="full_list_link" id="method_list_link"
        href="method_list.html">
      Method List
    </a>
  
    <a class="full_list_link" id="file_list_link"
        href="file_list.html">
      File List
    </a>
  
</div>
      <div class="clear"></div>
    </div>

    <iframe id="search_frame"></iframe>

    <div id="content"><div id='filecontents'><pre class="code ruby"><span class='comment'># -*- coding: utf-8 -*-
</span>
<span class='comment'># This module extends the Group model by group import methods.
</span><span class='comment'># This allows, for example, to import groups from a previous application or to auto-load
</span><span class='comment'># a certain default group structure.
</span><span class='comment'>#
</span><span class='comment'># The module is included in the Group model by `include GroupMixins::Import`.
</span><span class='comment'># The methods of the module can be accessed just like any other Group model methods:
</span><span class='comment'>#    Group.class_method()
</span><span class='comment'>#    g = Group.new()
</span><span class='comment'>#    g.instance_method()
</span><span class='comment'>#
</span><span class='kw'>module</span> <span class='const'>GroupMixins</span><span class='op'>::</span><span class='const'>Import</span>

  <span class='id identifier rubyid_extend'>extend</span> <span class='const'>ActiveSupport</span><span class='op'>::</span><span class='const'>Concern</span>

  <span class='id identifier rubyid_included'>included</span> <span class='kw'>do</span>
  <span class='kw'>end</span>


  <span class='comment'># Hash Array Import
</span>  <span class='comment'># ==========================================================================================
</span>
  <span class='kw'>module</span> <span class='const'>ClassMethods</span>

    <span class='comment'># Import Hash Array of groups into a parent group.
</span>    <span class='comment'># Each group in the array is represented by a hash. Each hash contains the attributes
</span>    <span class='comment'># of the group. The group&#39;s children are represented by another hash array, which is
</span>    <span class='comment'># stored at the `children` key.
</span>    <span class='comment'>#
</span>    <span class='comment'># The hash array should like this:
</span>    <span class='comment'>#     [
</span>    <span class='comment'>#         {
</span>    <span class='comment'>#             :name =&gt; &quot;Group 1&quot;,
</span>    <span class='comment'>#             :children =&gt; [
</span>    <span class='comment'>#                 {
</span>    <span class='comment'>#                     :name =&gt; &quot;Group 1.1&quot;
</span>    <span class='comment'>#                 },
</span>    <span class='comment'>#                 {
</span>    <span class='comment'>#                     :name =&gt; &quot;Group 1.2&quot;
</span>    <span class='comment'>#                 }
</span>    <span class='comment'>#             ]
</span>    <span class='comment'>#         }
</span>    <span class='comment'>#     ]
</span>    <span class='comment'>#
</span>    <span class='comment'># This is a helper method, which is used by other import methods like
</span>    <span class='comment'># `json_import_groups_into_parent_group`.
</span>    <span class='comment'>#
</span>    <span class='kw'>def</span> <span class='id identifier rubyid_hash_array_import_groups_into_parent_group'>hash_array_import_groups_into_parent_group</span><span class='lparen'>(</span> <span class='id identifier rubyid_hash_array_of_groups'>hash_array_of_groups</span><span class='comma'>,</span> <span class='id identifier rubyid_parent_group'>parent_group</span> <span class='rparen'>)</span>
      <span class='kw'>return</span> <span class='kw'>unless</span> <span class='id identifier rubyid_hash_array_of_groups'>hash_array_of_groups</span>
      <span class='id identifier rubyid_counter_for_created_groups'>counter_for_created_groups</span> <span class='op'>=</span> <span class='int'>0</span>

      <span class='kw'>for</span> <span class='id identifier rubyid_new_group_hash'>new_group_hash</span> <span class='kw'>in</span> <span class='id identifier rubyid_hash_array_of_groups'>hash_array_of_groups</span> <span class='kw'>do</span>

        <span class='kw'>unless</span> <span class='id identifier rubyid_parent_group'>parent_group</span><span class='period'>.</span><span class='id identifier rubyid_children'>children</span><span class='period'>.</span><span class='id identifier rubyid_select'>select</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_child'>child</span><span class='op'>|</span> <span class='id identifier rubyid_child'>child</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span> <span class='op'>==</span> <span class='id identifier rubyid_new_group_hash'>new_group_hash</span><span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>name</span><span class='tstring_end'>&quot;</span></span> <span class='rbracket'>]</span> <span class='rbrace'>}</span><span class='period'>.</span><span class='id identifier rubyid_count'>count</span> <span class='op'>&gt;</span> <span class='int'>0</span>

          <span class='comment'># get children from hash
</span>          <span class='id identifier rubyid_sub_group_hash_array'>sub_group_hash_array</span> <span class='op'>=</span> <span class='id identifier rubyid_new_group_hash'>new_group_hash</span><span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>children</span><span class='tstring_end'>&quot;</span></span> <span class='rbracket'>]</span>
          <span class='id identifier rubyid_sub_group_hash_array'>sub_group_hash_array</span> <span class='op'>=</span> <span class='id identifier rubyid_new_group_hash'>new_group_hash</span><span class='lbracket'>[</span> <span class='symbol'>:children</span> <span class='rbracket'>]</span> <span class='kw'>unless</span> <span class='id identifier rubyid_sub_group_hash_array'>sub_group_hash_array</span>
          <span class='id identifier rubyid_new_group_hash'>new_group_hash</span><span class='period'>.</span><span class='id identifier rubyid_reject!'>reject!</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_key'>key</span><span class='op'>|</span> <span class='kw'>not</span> <span class='const'>Group</span><span class='period'>.</span><span class='id identifier rubyid_attr_accessible'>attr_accessible</span><span class='lbracket'>[</span><span class='symbol'>:default</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span> <span class='id identifier rubyid_key'>key</span> <span class='rbrace'>}</span>

          <span class='comment'># create the new group
</span>          <span class='id identifier rubyid_g'>g</span> <span class='op'>=</span> <span class='const'>Group</span><span class='period'>.</span><span class='id identifier rubyid_create'>create</span><span class='lparen'>(</span> <span class='id identifier rubyid_new_group_hash'>new_group_hash</span> <span class='rparen'>)</span>
          <span class='id identifier rubyid_g'>g</span><span class='period'>.</span><span class='id identifier rubyid_parent_groups'>parent_groups</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_parent_group'>parent_group</span>
          <span class='id identifier rubyid_g'>g</span><span class='period'>.</span><span class='id identifier rubyid_set_flags_based_on_group_name'>set_flags_based_on_group_name</span>
          <span class='id identifier rubyid_g'>g</span><span class='period'>.</span><span class='id identifier rubyid_save'>save</span>

          <span class='comment'># import the child&#39;s children as well
</span>          <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_hash_array_import_groups_into_parent_group'>hash_array_import_groups_into_parent_group</span> <span class='id identifier rubyid_sub_group_hash_array'>sub_group_hash_array</span><span class='comma'>,</span> <span class='id identifier rubyid_g'>g</span> <span class='kw'>if</span> <span class='id identifier rubyid_sub_group_hash_array'>sub_group_hash_array</span>
          <span class='id identifier rubyid_counter_for_created_groups'>counter_for_created_groups</span> <span class='op'>+=</span> <span class='int'>1</span>

        <span class='kw'>end</span>
      <span class='kw'>end</span>

      <span class='kw'>return</span> <span class='id identifier rubyid_counter_for_created_groups'>counter_for_created_groups</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span> <span class='op'>+</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'> groups created.</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>end</span>

    <span class='comment'># Convert an array of group names, like
</span>    <span class='comment'>#
</span>    <span class='comment'>#   [ &quot;Group 1&quot;,
</span>    <span class='comment'>#     { &quot;Group 2&quot; =&gt; [ &quot;Group 2.1&quot;, &quot;Group 2.2&quot; ] },
</span>    <span class='comment'>#     ... ]
</span>    <span class='comment'>#
</span>    <span class='comment'># into an array of hashes as used by the `hash_array_import_groups_into_parent_group`
</span>    <span class='comment'># method.  The result looks like this:
</span>    <span class='comment'>#
</span>    <span class='comment'>#   [
</span>    <span class='comment'>#      { :name =&gt; &quot;Group 1&quot; },
</span>    <span class='comment'>#      { :name =&gt; &quot;Group 2&quot;, children: [
</span>    <span class='comment'>#                                         { name: &quot;Group 2.1&quot; },
</span>    <span class='comment'>#                                         { name: &quot;Group 2.2&quot; }
</span>    <span class='comment'>#                                      ]
</span>    <span class='comment'>#      },
</span>    <span class='comment'>#      ...
</span>    <span class='comment'>#   ]
</span>    <span class='comment'>#
</span>    <span class='comment'># This method is used in the YAML import mechanism.
</span>    <span class='comment'>#
</span>    <span class='kw'>def</span> <span class='id identifier rubyid_convert_group_names_to_group_hashes'>convert_group_names_to_group_hashes</span><span class='lparen'>(</span> <span class='id identifier rubyid_group_names'>group_names</span> <span class='rparen'>)</span>
      <span class='id identifier rubyid_group_names'>group_names</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_array_item'>array_item</span><span class='op'>|</span>
        <span class='kw'>if</span> <span class='id identifier rubyid_array_item'>array_item</span><span class='period'>.</span><span class='id identifier rubyid_kind_of?'>kind_of?</span> <span class='const'>String</span>
          <span class='lbrace'>{</span> <span class='label'>name:</span> <span class='id identifier rubyid_array_item'>array_item</span> <span class='rbrace'>}</span>
        <span class='kw'>elsif</span> <span class='id identifier rubyid_array_item'>array_item</span><span class='period'>.</span><span class='id identifier rubyid_kind_of?'>kind_of?</span> <span class='const'>Hash</span>
          <span class='kw'>unless</span> <span class='id identifier rubyid_array_item'>array_item</span><span class='lbracket'>[</span> <span class='symbol'>:name</span> <span class='rbracket'>]</span>
            <span class='lbrace'>{</span> <span class='label'>name:</span> <span class='id identifier rubyid_array_item'>array_item</span><span class='period'>.</span><span class='id identifier rubyid_keys'>keys</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span><span class='comma'>,</span>
              <span class='label'>children:</span> <span class='id identifier rubyid_convert_group_names_to_group_hashes'>convert_group_names_to_group_hashes</span><span class='lparen'>(</span> <span class='id identifier rubyid_array_item'>array_item</span><span class='lbracket'>[</span> <span class='id identifier rubyid_array_item'>array_item</span><span class='period'>.</span><span class='id identifier rubyid_keys'>keys</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span> <span class='rbracket'>]</span> <span class='rparen'>)</span>
            <span class='rbrace'>}</span>
          <span class='kw'>end</span>
        <span class='kw'>end</span>
      <span class='kw'>end</span>
    <span class='kw'>end</span>

  <span class='kw'>end</span>


  <span class='comment'># CSV Import
</span>  <span class='comment'># ==========================================================================================
</span>
  <span class='kw'>module</span> <span class='const'>ClassMethods</span>

    <span class='comment'># Import groups listed in a comma-separated-values file (CSV) into a parent group.
</span>    <span class='comment'># The CSV format should look like this:
</span>    <span class='comment'>#
</span>    <span class='comment'>#    token;name
</span>    <span class='comment'>#    GA;Group A
</span>    <span class='comment'>#    GB;Group B
</span>    <span class='comment'>#
</span>    <span class='comment'># Feel free to use other attributes in the CSV file as well. They will simply be
</span>    <span class='comment'># converted into a hash and then passed to a `create` method.
</span>    <span class='comment'>#
</span>    <span class='comment'># Note: This script expects a semicolon (;) to be used as separator.
</span>    <span class='comment'>#
</span>    <span class='comment'># The csv file is to be placed in the #{Rails.root}/import folder of the main
</span>    <span class='comment'># application. For the file #{Rails.root}/import/foo_groups.csv, call:
</span>    <span class='comment'>#
</span>    <span class='comment'>#    Group.csv_import_groups_into_parent_group( &quot;foo_groups.csv&quot;, foo_parent_group )
</span>    <span class='comment'>#
</span>    <span class='kw'>def</span> <span class='id identifier rubyid_csv_import_groups_into_parent_group'>csv_import_groups_into_parent_group</span><span class='lparen'>(</span> <span class='id identifier rubyid_csv_file_title'>csv_file_title</span><span class='comma'>,</span> <span class='id identifier rubyid_parent_group'>parent_group</span> <span class='rparen'>)</span>
      <span class='id identifier rubyid_import_file_name'>import_file_name</span> <span class='op'>=</span> <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span><span class='lparen'>(</span> <span class='const'>Rails</span><span class='period'>.</span><span class='id identifier rubyid_root'>root</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>import</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_csv_file_title'>csv_file_title</span> <span class='rparen'>)</span>
      <span class='id identifier rubyid_require'>require</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>csv</span><span class='tstring_end'>&#39;</span></span>
      <span class='const'>CSV</span><span class='period'>.</span><span class='id identifier rubyid_foreach'>foreach</span> <span class='id identifier rubyid_import_file_name'>import_file_name</span><span class='comma'>,</span> <span class='label'>headers:</span> <span class='kw'>true</span><span class='comma'>,</span> <span class='label'>col_sep:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>;</span><span class='tstring_end'>&#39;</span></span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_row'>row</span><span class='op'>|</span>

        <span class='id identifier rubyid_new_child_group'>new_child_group</span> <span class='op'>=</span> <span class='const'>Group</span><span class='period'>.</span><span class='id identifier rubyid_create'>create</span> <span class='id identifier rubyid_row'>row</span><span class='period'>.</span><span class='id identifier rubyid_to_hash'>to_hash</span>
        <span class='id identifier rubyid_parent_group'>parent_group</span><span class='period'>.</span><span class='id identifier rubyid_child_groups'>child_groups</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_new_child_group'>new_child_group</span>

      <span class='kw'>end</span>
    <span class='kw'>end</span>

  <span class='kw'>end</span>


  <span class='comment'># JSON Import
</span>  <span class='comment'># ==========================================================================================
</span>
  <span class='kw'>module</span> <span class='const'>ClassMethods</span>

    <span class='comment'># Import groups from a JSON format file into a parent group.
</span>    <span class='comment'># The JSON file should look like this:
</span>    <span class='comment'>#
</span>    <span class='comment'>#     [
</span>    <span class='comment'>#         {
</span>    <span class='comment'>#             &quot;name&quot;: &quot;Group 1&quot;,
</span>    <span class='comment'>#             &quot;children&quot;:
</span>    <span class='comment'>#             [
</span>    <span class='comment'>#                 {
</span>    <span class='comment'>#                     &quot;name&quot;: &quot;Group 1.1&quot;
</span>    <span class='comment'>#                 },
</span>    <span class='comment'>#                 {
</span>    <span class='comment'>#                     &quot;name&quot;: &quot;Group 1.2&quot;,
</span>    <span class='comment'>#                     &quot;children&quot;:
</span>    <span class='comment'>#                     [
</span>    <span class='comment'>#                         {
</span>    <span class='comment'>#                             &quot;name&quot;: &quot;Group 1.2.1&quot;
</span>    <span class='comment'>#                         },
</span>    <span class='comment'>#                         {
</span>    <span class='comment'>#                             &quot;name&quot;: &quot;Group 1.2.2&quot;
</span>    <span class='comment'>#                         }
</span>    <span class='comment'>#                     ]
</span>    <span class='comment'>#                 }
</span>    <span class='comment'>#             ]
</span>    <span class='comment'>#         },
</span>    <span class='comment'>#         {
</span>    <span class='comment'>#             &quot;name&quot;: &quot;Group 2&quot;
</span>    <span class='comment'>#         }
</span>    <span class='comment'>#     ]
</span>    <span class='comment'>#
</span>    <span class='comment'># The json file is to be placed in the #{Rails.root}/import folder of the main
</span>    <span class='comment'># application. For the file #{Rails.root}/import/foo_groups.json, call:
</span>    <span class='comment'>#
</span>    <span class='comment'>#    Group.json_import_groups_into_parent_group( &quot;foo_groups.json&quot;, foo_parent_group )
</span>    <span class='comment'>#
</span>    <span class='kw'>def</span> <span class='id identifier rubyid_json_import_groups_into_parent_group'>json_import_groups_into_parent_group</span><span class='lparen'>(</span> <span class='id identifier rubyid_json_file_title'>json_file_title</span><span class='comma'>,</span> <span class='id identifier rubyid_parent_group'>parent_group</span> <span class='rparen'>)</span>
      <span class='id identifier rubyid_raise'>raise</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>no parent group given during import</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>unless</span> <span class='id identifier rubyid_parent_group'>parent_group</span>
      <span class='id identifier rubyid_import_json_file'>import_json_file</span> <span class='op'>=</span> <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_open'>open</span><span class='lparen'>(</span> <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span><span class='lparen'>(</span> <span class='const'>Rails</span><span class='period'>.</span><span class='id identifier rubyid_root'>root</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>import</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_json_file_title'>json_file_title</span> <span class='rparen'>)</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>r</span><span class='tstring_end'>&quot;</span></span> <span class='rparen'>)</span>
      <span class='id identifier rubyid_json'>json</span> <span class='op'>=</span> <span class='const'>IO</span><span class='period'>.</span><span class='id identifier rubyid_read'>read</span><span class='lparen'>(</span> <span class='id identifier rubyid_import_json_file'>import_json_file</span> <span class='rparen'>)</span>

      <span class='id identifier rubyid_new_child_groups_hash_array'>new_child_groups_hash_array</span> <span class='op'>=</span> <span class='const'>JSON</span><span class='period'>.</span><span class='id identifier rubyid_parse'>parse</span><span class='lparen'>(</span> <span class='id identifier rubyid_json'>json</span> <span class='rparen'>)</span>
      <span class='id identifier rubyid_p'>p</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_hash_array_import_groups_into_parent_group'>hash_array_import_groups_into_parent_group</span> <span class='id identifier rubyid_new_child_groups_hash_array'>new_child_groups_hash_array</span><span class='comma'>,</span> <span class='id identifier rubyid_parent_group'>parent_group</span>
    <span class='kw'>end</span>

  <span class='kw'>end</span>


  <span class='comment'># YAML Import
</span>  <span class='comment'># ==========================================================================================
</span>
  <span class='kw'>module</span> <span class='const'>ClassMethods</span>

    <span class='comment'># Import the groups of a YAML file into a parent group.
</span>    <span class='comment'># The YAML file should look like this:
</span>    <span class='comment'>#
</span>    <span class='comment'>#   - Group 1
</span>    <span class='comment'>#   - Group 2:
</span>    <span class='comment'>#       - Group 2.1:
</span>    <span class='comment'>#           - Group 2.1.1
</span>    <span class='comment'>#           - Group 2.1.2
</span>    <span class='comment'>#       - Group 2.2
</span>    <span class='comment'>#   - Group 3:
</span>    <span class='comment'>#       - Group 3.1
</span>    <span class='comment'># 
</span>    <span class='comment'># The YAML files are expected to be stored in the `#{Rails.root}/import` directory 
</span>    <span class='comment'># of the main application. For example, the file `#{Rails.root}/import/foo.yml`
</span>    <span class='comment'># is imported by calling:
</span>    <span class='comment'># 
</span>    <span class='comment'>#    Group.yaml_import_groups_into_parent_group( &quot;foo.yml&quot;, parent_group )
</span>    <span class='comment'># 
</span>    <span class='kw'>def</span> <span class='id identifier rubyid_yaml_import_groups_into_parent_group'>yaml_import_groups_into_parent_group</span><span class='lparen'>(</span> <span class='id identifier rubyid_yaml_file_title'>yaml_file_title</span><span class='comma'>,</span> <span class='id identifier rubyid_parent_group'>parent_group</span> <span class='rparen'>)</span>
      <span class='id identifier rubyid_yaml_file_name'>yaml_file_name</span> <span class='op'>=</span> <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span><span class='lparen'>(</span> <span class='const'>Rails</span><span class='period'>.</span><span class='id identifier rubyid_root'>root</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>import</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_yaml_file_title'>yaml_file_title</span> <span class='rparen'>)</span>
      <span class='kw'>if</span> <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_exists?'>exists?</span> <span class='id identifier rubyid_yaml_file_name'>yaml_file_name</span>

        <span class='id identifier rubyid_sub_group_hashes'>sub_group_hashes</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
        <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_open'>open</span><span class='lparen'>(</span> <span class='id identifier rubyid_yaml_file_name'>yaml_file_name</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>r</span><span class='tstring_end'>&quot;</span></span> <span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_file'>file</span><span class='op'>|</span>
          <span class='id identifier rubyid_sub_group_hashes'>sub_group_hashes</span> <span class='op'>=</span> <span class='const'>YAML</span><span class='op'>::</span><span class='id identifier rubyid_load'>load</span><span class='lparen'>(</span><span class='id identifier rubyid_file'>file</span><span class='rparen'>)</span>
        <span class='kw'>end</span>
        
        <span class='comment'># This allows to use a short-form of yaml. Because of this, one doesn&#39;t need to
</span>        <span class='comment'># specify the `name` attribute in yaml, but can just use the group name as key,
</span>        <span class='comment'># like shown above in the description of the `yaml_import_groups_into_parent_group`
</span>        <span class='comment'># method.
</span>        <span class='id identifier rubyid_sub_group_hashes'>sub_group_hashes</span> <span class='op'>=</span> <span class='id identifier rubyid_convert_group_names_to_group_hashes'>convert_group_names_to_group_hashes</span><span class='lparen'>(</span> <span class='id identifier rubyid_sub_group_hashes'>sub_group_hashes</span> <span class='rparen'>)</span>

        <span class='const'>Group</span><span class='period'>.</span><span class='id identifier rubyid_hash_array_import_groups_into_parent_group'>hash_array_import_groups_into_parent_group</span><span class='lparen'>(</span> <span class='id identifier rubyid_sub_group_hashes'>sub_group_hashes</span><span class='comma'>,</span> <span class='id identifier rubyid_parent_group'>parent_group</span> <span class='rparen'>)</span>

      <span class='kw'>else</span>
        <span class='kw'>return</span> <span class='kw'>false</span>
      <span class='kw'>end</span>
    <span class='kw'>end</span>

  <span class='kw'>end</span>


  <span class='comment'># Import of the Default Sub-Structure of a Group
</span>  <span class='comment'># ==========================================================================================
</span>
  <span class='comment'># Import the default group structure.
</span>  <span class='comment'># This is called after creation of the group.
</span>  <span class='comment'>#
</span>  <span class='comment'># The structure is to be placed in a file at
</span>  <span class='comment'>#   #{Rails.root}/import/default_group_sub_structures/#{self.name}.yml
</span>  <span class='comment'># and is to be formatted in yaml, like this:
</span>  <span class='comment'>#
</span>  <span class='comment'>#   - Group 1
</span>  <span class='comment'>#   - Group 2:
</span>  <span class='comment'>#       - Group 2.1:
</span>  <span class='comment'>#           - Group 2.1.1
</span>  <span class='comment'>#           - Group 2.1.2
</span>  <span class='comment'>#       - Group 2.2
</span>  <span class='comment'>#   - Group 3:
</span>  <span class='comment'>#       - Group 3.1
</span>  <span class='comment'>#
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_import_default_group_structure'>import_default_group_structure</span><span class='lparen'>(</span> <span class='id identifier rubyid_yaml_file_title'>yaml_file_title</span> <span class='op'>=</span> <span class='kw'>nil</span> <span class='rparen'>)</span>
    <span class='id identifier rubyid_yaml_file_title'>yaml_file_title</span> <span class='op'>||=</span> <span class='id identifier rubyid_yaml_file_title'>yaml_file_title</span> <span class='op'>=</span> <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span><span class='lparen'>(</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>default_group_sub_structures</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
                                                     <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span><span class='embexpr_end'>}</span><span class='tstring_content'>.yml</span><span class='tstring_end'>&quot;</span></span> <span class='rparen'>)</span>
    <span class='id identifier rubyid_parent_group'>parent_group</span> <span class='op'>=</span> <span class='kw'>self</span>
    <span class='const'>Group</span><span class='period'>.</span><span class='id identifier rubyid_yaml_import_groups_into_parent_group'>yaml_import_groups_into_parent_group</span><span class='lparen'>(</span> <span class='id identifier rubyid_yaml_file_title'>yaml_file_title</span><span class='comma'>,</span> <span class='id identifier rubyid_parent_group'>parent_group</span> <span class='rparen'>)</span>
  <span class='kw'>end</span>


  <span class='comment'># Special Groups
</span>  <span class='comment'># ==========================================================================================
</span>
  <span class='comment'># When importing group structures, certain group names indicate special group attributes.
</span>  <span class='comment'># This method sets these flags based on the group name.
</span>  <span class='comment'># 
</span>  <span class='comment'># This method is called by the `hash_array_import_groups_into_parent_group` method.
</span>  <span class='comment'># 
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_set_flags_based_on_group_name'>set_flags_based_on_group_name</span> 

    <span class='comment'># Officers
</span>    <span class='id identifier rubyid_translations'>translations</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
    <span class='const'>I18n</span><span class='period'>.</span><span class='id identifier rubyid_translate'>translate</span><span class='lparen'>(</span> <span class='symbol'>:officers_parent</span> <span class='rparen'>)</span> <span class='comment'># required to initialize the I18n 
</span>    <span class='const'>I18n</span><span class='period'>.</span><span class='id identifier rubyid_backend'>backend</span><span class='period'>.</span><span class='id identifier rubyid_send'>send</span><span class='lparen'>(</span> <span class='symbol'>:translations</span> <span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_language'>language</span><span class='comma'>,</span> <span class='id identifier rubyid_translations_hash'>translations_hash</span><span class='op'>|</span>
      <span class='id identifier rubyid_translations'>translations</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_translations_hash'>translations_hash</span><span class='lbracket'>[</span> <span class='symbol'>:officers_parent</span> <span class='rbracket'>]</span>
    <span class='kw'>end</span>
    <span class='kw'>if</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span><span class='period'>.</span><span class='id identifier rubyid_in?'>in?</span> <span class='id identifier rubyid_translations'>translations</span>
      <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_add_flag'>add_flag</span><span class='lparen'>(</span> <span class='symbol'>:officers_parent</span> <span class='rparen'>)</span>
    <span class='kw'>end</span>

    <span class='comment'># Guests
</span>    <span class='id identifier rubyid_translations'>translations</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
    <span class='const'>I18n</span><span class='period'>.</span><span class='id identifier rubyid_translate'>translate</span><span class='lparen'>(</span> <span class='symbol'>:guests_parent</span> <span class='rparen'>)</span> <span class='comment'># required to initialize the I18n 
</span>    <span class='const'>I18n</span><span class='period'>.</span><span class='id identifier rubyid_backend'>backend</span><span class='period'>.</span><span class='id identifier rubyid_send'>send</span><span class='lparen'>(</span> <span class='symbol'>:translations</span> <span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_language'>language</span><span class='comma'>,</span> <span class='id identifier rubyid_translations_hash'>translations_hash</span><span class='op'>|</span>
      <span class='id identifier rubyid_translations'>translations</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_translations_hash'>translations_hash</span><span class='lbracket'>[</span> <span class='symbol'>:guests_parent</span> <span class='rbracket'>]</span>
    <span class='kw'>end</span>
    <span class='kw'>if</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span><span class='period'>.</span><span class='id identifier rubyid_in?'>in?</span> <span class='id identifier rubyid_translations'>translations</span>
      <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_add_flag'>add_flag</span><span class='lparen'>(</span> <span class='symbol'>:guests_parent</span> <span class='rparen'>)</span>
    <span class='kw'>end</span>

  <span class='kw'>end</span>

<span class='kw'>end</span></pre></div></div>

    <div id="footer">
  Generated on Sat Mar 23 00:23:00 2013 by
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.8.5.2 (ruby-2.0.0).
</div>

  </body>
</html>